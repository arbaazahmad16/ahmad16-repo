create a directory:
mkdir monitoring
download helm:
curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-4
get executable:
chmod 700 get_helm.sh
run:
./get_helm.sh
create a namespace:
kubectl create namespace monitoring
add helm prometheus community repo:
helm repo add prometheus-community https://prometheus-community.github.io/helm-charts
list repo:
helm repo list
update repo:
helm repo update
install prometheus and grafana stack:
helm install prometheus-stack prometheus-community/kube-prometheus-stack --namespace monitoring --set prometheus.service.nodePort=30000 --set grafana.service.nodePort=31000 --set grafana.service.type=NodePort --set prometheus.service.type=NodePort
get its services:
kubectl get svc -n monitoring
forward ports:
kubectl port-forward svc/prometheus-stack-kube-prom-prometheus -n monitoring 9090:9090 &
kubectl port-forward svc/prometheus-stack-grafana -n monitoring 3000:80
clone voting-app repo:
git clone https://github.com/arbaazahmad16/k8s-kind-voting-app.git
goto below dir:
cd k8s-kind-voting-app/k8s-specifications/
apply all yml:
kubectl apply -f .
get its services:
kubectl get svc
forward ports:
kubectl port-forward svc/vote 5000:5000 &
kubectl port-forward svc/result 5001:5001 &
